(this["webpackJsonpfragment-player-example"]=this["webpackJsonpfragment-player-example"]||[]).push([[0],{14:function(e,t,n){"use strict";n.r(t);n(9);var r=n(0),a=n.n(r),o=n(7),i=n.n(o),u=n(2),l=n(5),c=n(4);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var s=function(e,t){return e.findIndex((function(e){var n=e.startAt,r=e.endAt;return t>=n&&t<=r}))},d=a.a.createContext({});var v=function(e){var t=e.children,n=e.fragments,o=Object(r.useState)(0),i=o[0],u=o[1],l=Object(r.useState)(),c=l[0],g=l[1],v=Object(r.useMemo)((function(){return function(e){var t=0,n=null===e||void 0===e?void 0:e.map((function(e){var n=e.fragmentEnd-e.fragmentBegin,r=m({},e,{startAt:t,endAt:t+n});return t+=n,r}));return{totalLength:t,enrichedFragments:n}}(n)}),[n]),p=v.totalLength,b=v.enrichedFragments,y=Object(r.useMemo)((function(){return s(b,i)})),h=Object(r.useMemo)((function(){for(var e,t={},r=f(n);!(e=r()).done;){var o=e.value;t["fragment-"+o.fragmentBegin+"-"+o.fragmentEnd]=a.a.createRef()}return t}),[n]),O=Object(r.useMemo)((function(){return b.map((function(e,t){var n="fragment-"+e.fragmentBegin+"-"+e.fragmentEnd;return a.a.createElement("video",{ref:h[n],id:n,src:e.src+"#t="+e.fragmentBegin+","+e.fragmentEnd,playsInline:!0,muted:"true",style:{width:"100%",position:"absolute",top:0,left:0,zIndex:y===t?10:0},onTimeUpdate:function(){if(c&&y===t){var r,a,o=(null===(r=h[n])||void 0===r||null===(a=r.current)||void 0===a?void 0:a.currentTime)-e.fragmentBegin+e.startAt;console.log({newTime:o,totalLength:p}),o>=p?(u(p),g(!1)):u(o)}}})}))}),[b,c,y]);Object(r.useEffect)((function(){var e=b[y];for(var t in console.log(e),h){var n,r;null===(n=h[t])||void 0===n||null===(r=n.current)||void 0===r||r.pause()}if(e&&c){var a,o,u="fragment-"+e.fragmentBegin+"-"+e.fragmentEnd;console.log("f.currentTime",i);var l=i-e.startAt;h[u].current.currentTime=e.fragmentBegin+l,null===(a=h[u])||void 0===a||null===(o=a.current)||void 0===o||o.play()}}),[y,c]);var E=Object(r.useMemo)((function(){return a.a.createElement("div",{style:{position:"relative"}},O)}),[O]);return a.a.createElement(d.Provider,{value:{Video:E,totalLength:p,currentTime:i,playing:c,enrichedFragments:b,seekTo:function(e){for(var t in h){var n,r;null===(n=h[t])||void 0===n||null===(r=n.current)||void 0===r||r.pause()}var a,o,i=b[s(b,e)],l="fragment-"+i.fragmentBegin+"-"+i.fragmentEnd,m=e-i.startAt;(h[l].current.currentTime=i.fragmentBegin+m,c)&&(null===(a=h[l])||void 0===a||null===(o=a.current)||void 0===o||o.play());u(e)},togglePlay:function(){if(c){var e,t,n=b[y],r="fragment-"+n.fragmentBegin+"-"+n.fragmentEnd;null===(e=h[r])||void 0===e||null===(t=e.current)||void 0===t||t.pause(),g(!1)}else{var a,o,i=b[y],u="fragment-"+i.fragmentBegin+"-"+i.fragmentEnd;null===(a=h[u])||void 0===a||null===(o=a.current)||void 0===o||o.play(),g(!0)}}}},t)},p=[{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4",fragmentBegin:0,fragmentEnd:5},{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4",fragmentBegin:1,fragmentEnd:25},{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4",fragmentBegin:1,fragmentEnd:3}],b=function(){var e=Object(r.useState)(!1),t=Object(c.a)(e,2),n=t[0],o=(t[1],Object(r.useState)(!1)),i=Object(c.a)(o,2),m=i[0],g=i[1],f=Object(r.useState)({fragments:p}),s=Object(c.a)(f,2),b=s[0],y=s[1],h=JSON.parse(JSON.stringify(null===b||void 0===b?void 0:b.fragments));return a.a.createElement(v,{fragments:m?[].concat(Object(l.a)(h.slice(0,1)),[Object(u.a)(Object(u.a)({},h[1]),{},{fragmentEnd:h[1].fragmentEnd+10})],Object(l.a)(h.slice(2))):h,loadVideo:n},a.a.createElement(d.Consumer,null,(function(e){var t=e.Video,n=e.seekTo,r=e.currentTime,o=e.totalLength,i=e.playing,l=e.togglePlay;return a.a.createElement("div",{style:{width:"75%",margin:"auto"}},a.a.createElement("button",{onClick:function(){return g(!m)}},"Simulate Edit"),a.a.createElement("button",{onClick:l},i?"Pause":"Play"),a.a.createElement("button",{onClick:function(){return y(Object(u.a)(Object(u.a)({},b),{},{extra:((null===b||void 0===b?void 0:b.extra)||"")+"asdf"}))}},"change data"),a.a.createElement("div",{style:{width:1600,height:900}},t),a.a.createElement("input",{style:{width:"100%"},type:"range",min:0,max:o,value:r,onChange:function(e){return n(parseInt(e.target.value))}}))})))};i.a.render(a.a.createElement(b,null),document.getElementById("root"))},8:function(e,t,n){e.exports=n(14)},9:function(e,t,n){}},[[8,1,2]]]);
//# sourceMappingURL=main.dd31f347.chunk.js.map