(this["webpackJsonpfragment-player-example"]=this["webpackJsonpfragment-player-example"]||[]).push([[0],{14:function(e,t,n){"use strict";n.r(t);n(9);var r=n(0),a=n.n(r),o=n(6),i=n.n(o),u=n(4),c=n(7),l=n(3);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var m=function(e,t){return e.findIndex((function(e){var n=e.startAt,r=e.endAt;return t>=n&&t<=r}))},s=a.a.createContext({});var g=function(e){var t=e.children,n=e.fragments,o=e.loadVideo,i=Object(r.useRef)(),u=Object(r.useRef)(),c=Object(r.useRef)(),l=Object(r.useState)(!1),v=l[0],g=l[1],p=Object(r.useState)(0),b=p[0],h=p[1],y=Object(r.useMemo)((function(){return function(e){var t=0,n=null===e||void 0===e?void 0:e.map((function(e){var n=e.fragmentEnd-e.fragmentBegin,r=d({},e,{startAt:t,endAt:t+n});return t+=n,r}));return{totalLength:t,enrichedFragments:n}}(n)}),[n]),E=y.totalLength,O=y.enrichedFragments,j=m(O,b),w=Object(r.useState)({}),S=w[0],A=S.width,B=S.height,k=w[1],C=Object(r.useState)(!1),I=C[0],L=C[1],T=Object(r.useState)(-1),x=T[0],P=T[1];Object(r.useEffect)((function(){var e=document.createElement("div");return e.style.display="none",e.id="fragment-dummy",document.body.appendChild(e),function(){return document.body.removeChild(e)}}),[]);var V=function(e){P(e)},F=function(){v?(g(!1),M[j].pause()):(g(!0),M[j].play())},R=o?a.a.createElement("div",{style:{width:"100%",height:"100%"},ref:u},a.a.createElement("canvas",{ref:i,style:{width:"100%"},onClick:F})):null;Object(r.useLayoutEffect)((function(){var e=function(){var e,t;k({width:null===u||void 0===u||null===(e=u.current)||void 0===e?void 0:e.clientWidth,height:null===u||void 0===u||null===(t=u.current)||void 0===t?void 0:t.clientHeight})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}})),Object(r.useEffect)((function(){var e,t;k({width:null===u||void 0===u||null===(e=u.current)||void 0===e?void 0:e.clientWidth,height:null===u||void 0===u||null===(t=u.current)||void 0===t?void 0:t.clientHeight})}),[null===i||void 0===i?void 0:i.current,null===u||void 0===u?void 0:u.current,o,I]);var M=Object(r.useMemo)((function(){return L(!1),o?null===O||void 0===O?void 0:O.map((function(e,t){var n=e.fragmentBegin+"-"+e.fragmentEnd+"-"+e.src,r=document.getElementById(n),a=r||document.createElement("video");(t||r?t||L(!0):(a.src=e.src,a.preload="auto",a.currentTime=e.fragmentBegin,a.load(),a.onloadeddata=function(){L(!0),V(t)}),r)||(a.id=n,document.getElementById("fragment-dummy").appendChild(a));return a})):[]}),[O,null===i||void 0===i?void 0:i.current,o]);return Object(r.useEffect)((function(){var e=x+1,t=M[e],n=O[e];t&&(t.src=n.src,t.preload="auto",t.currentTime=n.fragmentBegin,t.load(),t.onloadeddata=function(){V(e)})}),[x]),Object(r.useEffect)((function(){var e=M[j];if(e){var t=function(){return e.play()};return v&&e&&e.addEventListener("canplay",t),function(){e.pause(),e.removeEventListener("canplay",t)}}}),[O,j,v,M]),Object(r.useEffect)((function(){v&&M[j].play()}),[j,b,v]),Object(r.useEffect)((function(){for(var e,t,n=f(M);!(t=n()).done;){t.value.pause()}if(M[j]&&I&&(null===i||void 0===i?void 0:i.current)&&R){var r=O[j];M[j].currentTime=b-r.startAt+(null===r||void 0===r?void 0:r.fragmentBegin),i.current.width=A,i.current.height=B;var a=null===i||void 0===i||null===(e=i.current)||void 0===e?void 0:e.getContext("2d");a.drawImage(M[j],0,0,A,B),clearInterval(null===c||void 0===c?void 0:c.current),c.current=setInterval((function(){var e,t,n,r=(null===(e=M[j])||void 0===e?void 0:e.currentTime)-(null===(t=O[j])||void 0===t?void 0:t.fragmentBegin)+(null===(n=O[j])||void 0===n?void 0:n.startAt);r>=E?(h(E),F()):r<=0?(h(0),F()):h(r),a.drawImage(M[j],0,0,A,B)}),30)}}),[O,j,A,B,I]),Object(r.useEffect)((function(){!o&&M&&g(!1)}),[o,M,null===u||void 0===u?void 0:u.current]),a.a.createElement(s.Provider,{value:{seekTo:function(e){if(m(O,b)===j){var t=O[j];M[j].currentTime=e-t.startAt+(null===t||void 0===t?void 0:t.fragmentBegin)}h(e)},togglePlay:F,setPlaying:g,ready:I,currentTime:b,totalLength:E,video:R,videos:M,playing:v,currentVideoIdx:j}},t)},p=[{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4",fragmentBegin:0,fragmentEnd:5},{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4",fragmentBegin:1,fragmentEnd:25},{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4",fragmentBegin:1,fragmentEnd:3}],b=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(!1),d=Object(l.a)(i,2),v=d[0],f=d[1];return a.a.createElement(g,{fragments:v?[Object(u.a)(Object(u.a)({},p[0]),{},{fragmentEnd:25})].concat(Object(c.a)(p.slice(1))):p,loadVideo:n},a.a.createElement(s.Consumer,null,(function(e){var t=e.seekTo,n=e.currentTime,r=e.totalLength,i=e.video,u=e.setPlaying,c=e.ready;return a.a.createElement("div",{style:{width:"75%",margin:"auto"}},a.a.createElement("button",{onClick:function(){return o(!0)}},"Show Video"),a.a.createElement("button",{onClick:function(){return f(!v)}},"Simulate Edit"),a.a.createElement("button",{onClick:function(){return u(!0)}},"Play"),a.a.createElement("button",{onClick:function(){return u(!1)}},"Pause"),i,a.a.createElement("input",{style:{width:"100%"},type:"range",min:0,max:r,value:n,onChange:function(e){return t(parseInt(e.target.value))}}),a.a.createElement("div",null,c?"Video Ready":"Video Loading..."))})))};i.a.render(a.a.createElement(b,null),document.getElementById("root"))},8:function(e,t,n){e.exports=n(14)},9:function(e,t,n){}},[[8,1,2]]]);
//# sourceMappingURL=main.de7d79da.chunk.js.map